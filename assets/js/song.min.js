function songPage(){function confirmDelete(evt){if(evt.preventDefault(),!confirm("Are you sure you want to delete this song?"))return!1;var formData=new FormData;return formData.set("delete","delete"),ajax(location.pathname,formData).post((function(status,obj){200===status?(isReload=!0,InstantClick.go("/")):document.getElementById("song-notif").innerText=obj.message||"Unknown error"})),!1}function confirmDeleteCover(evt){if(evt.preventDefault(),!confirm("Are you sure you want to delete the cover?"))return!1;var formData=new FormData;return formData.set("delete-cover","delete-cover"),ajax(location.pathname,formData).post((function(status,obj){200!==status&&(document.getElementById("song-notif").innerText=obj.message||"Unknown error")})),!1}registerCover(),document.getElementById("delete-button").addEventListener("click",confirmDelete);var dc=document.getElementById("delete-cover");function saveVolumeChange(evt){localStorage.setItem("audio-volume",evt.target.volume)}dc&&dc.addEventListener("click",confirmDeleteCover);var audioElement=document.getElementsByTagName("audio")[0];if(NaN==audioElement.duration&&(audioElement.src=document.getElementsByClassName("source")[0].src),"mediaSession"in navigator){var coverSizeSpan=document.querySelector(".cover-image-size"),coverImage=document.getElementById("song-cover"),artwork=[];coverSizeSpan&&coverImage&&(artwork.push({src:coverImage.src+"?size=small",sizes:"120x120"}),artwork.push({src:coverImage.src,sizes:coverImage.dataset.size+"x"+coverImage.dataset.size})),navigator.mediaSession.metadata=new MediaMetadata({title:document.getElementById("song-title").value,artist:document.getElementById("song-artist").value,album:document.getElementById("song-album").value,artwork:artwork})}audioElement.load(),audioElement.volume=localStorage.getItem("audio-volume")||0,0==audioElement.volume&&(audioElement.volume=.5),audioElement.addEventListener("volumechange",saveVolumeChange);var songDownloadButton=document.getElementById("download-song-button");function removeLoading(evt){songDownloadButton.classList.remove("is-loading")}function downloadButtonClicked(){songDownloadButton.classList.add("is-loading")}songDownloadButton.addEventListener("click",downloadButtonClicked),songDownloadButton.addEventListener("blur",removeLoading)}